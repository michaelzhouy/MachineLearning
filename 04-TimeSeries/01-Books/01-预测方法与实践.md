

## 时间序列分解

### 时间序列成分
1. 加法
$$y_t = S_t + T_t + R_t$$
$y_t$表示时间序列数据, $S_t$表示季节项, $T_t$表示趋势-周期项, $R_t$表示残差项

2. 乘法
$$y_t = S_t \times T_t \times R_t$$

取对数

$$log \, y_t = log \, S_t + log \, T_t + log \, R_t$$

### 移动平均
1. 平滑移动平均: 时间点$t$的趋势-周期项的估计值是通过求$t$时刻的k周期内的平均得到的
$$\hat T_t = \frac{1}{m}\sum_{j=-k}^{k}y_{t+j}$$
其中$m=2k+1$

2. 移动平均的移动平均

$2 \times 4-MA$写成如下形式

$$\hat T_t = \frac{1}{2}[\frac{1}{4}(y_{t-2}+y_{t-1}+y_t+y_{t+1}) + \frac{1}{4}(y_{t-1}+y_{t}+y_{t+1}+y_{t+2})] =\\
\frac{1}{8}y_{t-2} + \frac{1}{4}y_{t-1} + \frac{1}{4}y_{t} + \frac{1}{4}y_{t+1} + \frac{1}{8}y_{t+2}$$

### 经典时间序列分解
1. 加法分解
- 若$m$为偶数, 用$2 \times m-MA$来计算趋势周期项$\hat T_t$. 若$m$为奇数, 用$m-MA$来计算趋势周期项$\hat T_t$
- 计算去趋势序列: $y_t-\hat T_t$
- 为了估计每个季度的季节项, 简单平均那个季度的去趋势值. 例如, 对于月度数据, 三月份的季节项是对所有去除趋势后的三月份的值的平均. 然后将这些季节项进行调整, 使得它们的加和为0. 季节项是通过将这些各年的数据排列结合在一起而得到的, 即$\hat S_t$
- 残差项是通过时间序列减去估计的季节项和趋势-周期项求得的: $\hat R_t = y_t - \hat T_t - \hat S_t$

2. 乘法分解
- 若$m$为偶数, 用$2 \times m-MA$来计算趋势周期项$\hat T_t$. 若$m$为奇数, 用$m-MA$来计算趋势周期项$\hat T_t$
- 计算去趋势序列: $y_t/\hat T_t$
- 为了估计每个季度的季节项, 简单平均那个季度的去趋势值. 例如, 对于月度数据, 三月份的季节项是对所有去除趋势后的三月份的值的平均. 然后将这些季节项进行调整, 使得它们的加和为0. 季节项是通过将这些各年的数据排列结合在一起而得到的, 即$\hat S_t$
- 残差项是通过时间序列除以估计的季节项和趋势-周期项求得的: $\hat R_t = y_t / (\hat T_t \hat S_t)$


## 指数平滑

### 简单的指数平滑
1. 朴素预测法
$$\hat y_{T+h|T} = y_T$$

2. 平均预测法
$$\hat y_{T+h|T} = \frac{1}{T}\sum_{t=1}^{T}y_t$$

3. 简单指数平滑: 向前一步$T+1$时刻的预测值是时间系列$y_1,...,y_T$中所有观察值的加权平均值. 权重下降的速度由参数$\alpha$控制
$$\hat y_{T+1|T} = \alpha \, y_T + \alpha \, (1 - \alpha) \, y_{T-1} + \alpha \, (1 - \alpha)^2 \, y_{T-2} + \alpha \, (1 - \alpha)^3 \, y_{T-3} + ...$$
其中$0<=\alpha<=1$是平滑参数

### 趋势法
1. Holt的线性趋势


## ARIMA模型

### 平稳性和差分

1. 平稳的时间序列的性质不随观测时间的变化而变化. 因此具有趋势或季节性的时间序列不是平稳时间序列——趋势和季节性使得时间序列在不同时段呈现不同性质. 与它们相反, 白噪声序列(white noise series)则是平稳的--不管观测的时间如何变化, 它看起来都应该是一样的
2. 一个平稳的时间序列从长期来看不存在可预测的特征. 它的时间曲线图(time plots)反映出这个序列近似于水平(尽管可能存在一些周期性的变化)并保持固定的方差

#### 差分
1. 对数变换的变换方法可用于平稳化(stabilize)时间序列的方差。差分则可以通过去除时间序列中的一些变化特征来平稳化它的均值，并因此消除（或减小）时间序列的趋势和季节性
2. 自相关图（ACF图）也能帮助我们识别非平稳时间序列。对于一个平稳时间序列,自相关系数（ACF）会快速的下降到接近 0 的水平，然而非平稳时间序列的自相关系数会下降的比较缓慢。同样的,非平稳时间序列的$r_1$通常非常大并且为正值

#### 随机游走模型
1. 差分序列, 长度为T-1
$$y_t' = y_t - y_{t-1}$$
当差分序列是白噪声时, 原序列的模型可以表示为
$$y_t - y_{t-1} = \varepsilon_t$$
其中$\varepsilon_t$是白噪声.

调整上式, 即可得到"随机游走"模型
$$y_t = y_{t-1} + \varepsilon_t$$
2. 随机游走模型具有以下特征:
- 长期的明显上升或下降趋势
- 游走方向上有突然的, 不能预测地变化

####  二阶差分
1. 有时差分后的数据仍然不平稳, 所以可能需要再一次对数据进行差分来得到一个平稳的序列:
$$y_t'' = y_t' - y_{t-1}'\\
=(y_t - y_{t-1}) - (y_{t-1} - y_{t-2})\\
=y_t - 2y_{t-1} + y_{t-2}$$
其中, 序列$y_t''$的长度为$T-2$

#### 季节性差分
1. 季节性差分是对一个观测值和相对应的前一年的观测值之间进行差分
$$y_t' = y_t - y_{t-m}$$
其中$m=一年中的季节数量$

2. 如果季节性差分数据是白噪声, 则原数据可以用一个合适的模型来拟合
$$y_t = y_{t-m} + \varepsilon_t$$

### 自回归模型
1. 一个$p$阶的自回归模型$AR(p)$可以表示为
$$y_t = c + \phi_1 y_{t-1} + \phi_2 y_{t-2} + ... + \phi_p y_{t-p} + \varepsilon_t$$
其中$\varepsilon_t$是白噪声

### 移动平均模型
1. 不同于使用预测变量的历史值来进行回归，移动平均模型$MA(q)$(moving average model)使用历史预测误差来建立一个类似回归的模型
$$y_t = c + \varepsilon_t + \phi_1 \varepsilon_{t-1} + \phi_2 \varepsilon_{t-2} + ... + \phi_p \varepsilon_{t-q}$$
其中, $\varepsilon_t$是白噪声


### 非季节性$ARIMA$模型

$$y_t = c + \phi_1 y_{t-1}' + ... + \phi_p y_{t-p}' + \theta_1 \varepsilon_{t-1} + ... + \theta_q \epsilon_{t-q} + \epsilon_t$$
其中$y_t'$是差分序列(可能经过多次差分)